2025-12-30 15:06:59,608 Namespace(data_path='data/', dataset='coco', margin=0.2, num_epochs=10, batch_size=128, embed_size=1024, grad_clip=2.0, learning_rate=0.0005, workers=8, log_step=200, val_step=500, logger_name='runs/coco_test', model_name='runs/coco_test', max_violation=False, img_dim=2048, no_imgnorm=False, no_txtnorm=False, vse_mean_warmup_epochs=1, multi_gpu=0, size_augment=1, mask_repeat=1, save_results=1, gpu_id=0, bert_path='/model/darkpromise/VSE_backbone/bert-base-uncased', lr_schedules=[15, 25], decay_rate=0.1, base_loss='trip', gnn_loss='trip', warmup=8000, residual_weight=0.8, num_layers_enc=1, nhead=16, dropout=0.1, graph_lr_factor=1.0, mask_weight=1.5, threshold=0.5, topk=10, reg_loss_weight=10, norm_input=1, cross_loss=1)
2025-12-30 15:10:49,233 Number of images for train-set: 113287
2025-12-30 15:10:56,385 Log saving path: runs/coco_test
2025-12-30 15:10:56,386 Models saving path: runs/coco_test
2025-12-30 15:10:56,386 image encoder trainable parameters: 9.52M
2025-12-30 15:10:56,387 txt encoder trainable parameters: 111.17M
2025-12-30 15:10:56,387 criterion trainable parameters: 6.01M
2025-12-30 15:13:57,542 Epoch: [0][200/4425]	Iter 200  lr 0.0005  Loss 50.3136 (51.7361)	Batch-Time 0.77 (0.91)	
2025-12-30 15:16:48,114 Epoch: [0][400/4425]	Iter 400  lr 0.0005  Loss 40.4652 (48.5080)	Batch-Time 0.90 (0.88)	
2025-12-30 15:19:40,659 Epoch: [0][600/4425]	Iter 600  lr 0.0005  Loss 35.9454 (45.8939)	Batch-Time 0.90 (0.87)	
2025-12-30 15:22:31,224 Epoch: [0][800/4425]	Iter 800  lr 0.0005  Loss 33.5083 (44.0132)	Batch-Time 1.01 (0.87)	
2025-12-30 15:25:20,767 Epoch: [0][1000/4425]	Iter 1000  lr 0.0005  Loss 38.1765 (42.6143)	Batch-Time 0.85 (0.86)	
2025-12-30 15:28:07,223 Epoch: [0][1200/4425]	Iter 1200  lr 0.0005  Loss 33.8850 (41.4993)	Batch-Time 0.85 (0.86)	
2025-12-30 15:30:55,318 Epoch: [0][1400/4425]	Iter 1400  lr 0.0005  Loss 38.0829 (40.5645)	Batch-Time 0.93 (0.86)	
2025-12-30 15:33:49,566 Epoch: [0][1600/4425]	Iter 1600  lr 0.0005  Loss 35.1764 (39.7431)	Batch-Time 1.21 (0.86)	
2025-12-30 15:36:39,249 Epoch: [0][1800/4425]	Iter 1800  lr 0.0005  Loss 32.8178 (39.0546)	Batch-Time 0.80 (0.86)	
2025-12-30 15:39:32,359 Epoch: [0][2000/4425]	Iter 2000  lr 0.0005  Loss 34.2579 (38.4486)	Batch-Time 0.83 (0.86)	
2025-12-30 15:42:21,580 Epoch: [0][2200/4425]	Iter 2200  lr 0.0005  Loss 33.5018 (37.9014)	Batch-Time 0.72 (0.86)	
2025-12-30 15:45:11,718 Epoch: [0][2400/4425]	Iter 2400  lr 0.0005  Loss 32.6352 (37.4373)	Batch-Time 0.88 (0.86)	
2025-12-30 15:48:00,114 Epoch: [0][2600/4425]	Iter 2600  lr 0.0005  Loss 33.4399 (36.9705)	Batch-Time 0.78 (0.86)	
2025-12-30 15:50:50,237 Epoch: [0][2800/4425]	Iter 2800  lr 0.0005  Loss 31.2941 (36.5562)	Batch-Time 0.82 (0.85)	
2025-12-30 15:53:43,061 Epoch: [0][3000/4425]	Iter 3000  lr 0.0005  Loss 30.6794 (36.1760)	Batch-Time 1.12 (0.86)	
2025-12-30 15:56:33,930 Epoch: [0][3200/4425]	Iter 3200  lr 0.0005  Loss 32.2563 (35.8429)	Batch-Time 1.01 (0.86)	
2025-12-30 15:59:19,762 Epoch: [0][3400/4425]	Iter 3400  lr 0.0005  Loss 30.9676 (35.5307)	Batch-Time 0.73 (0.85)	
2025-12-30 16:02:07,120 Epoch: [0][3600/4425]	Iter 3600  lr 0.0005  Loss 30.6513 (35.2152)	Batch-Time 0.80 (0.85)	
2025-12-30 16:04:55,754 Epoch: [0][3800/4425]	Iter 3800  lr 0.0005  Loss 27.5250 (34.9405)	Batch-Time 0.80 (0.85)	
2025-12-30 16:07:49,793 Epoch: [0][4000/4425]	Iter 4000  lr 0.0005  Loss 31.8648 (34.6822)	Batch-Time 0.82 (0.85)	
2025-12-30 16:10:43,876 Epoch: [0][4200/4425]	Iter 4200  lr 0.0005  Loss 29.6266 (34.4295)	Batch-Time 1.01 (0.85)	
2025-12-30 16:13:34,447 Epoch: [0][4400/4425]	Iter 4400  lr 0.0005  Loss 31.7074 (34.2089)	Batch-Time 0.82 (0.85)	
2025-12-30 16:13:56,274 Test: [0/196]		Batch-Time 1.400 (1.400)	
2025-12-30 16:14:57,486 Image to text (R@1, R@5, R@10): 49.1, 76.8, 85.7
2025-12-30 16:14:59,468 Text to image (R@1, R@5, R@10): 33.1, 63.0, 75.0
2025-12-30 16:14:59,469 Current rsum is 382.6
2025-12-30 16:14:59,474 Epoch: [0], Best rsum: 382.6
2025-12-30 16:17:30,581 Epoch: [1][175/4425]	Iter 4600  lr 0.0005  Loss 31.8492 (28.3347)	Batch-Time 0.72 (0.86)	
2025-12-30 16:20:20,917 Epoch: [1][375/4425]	Iter 4800  lr 0.0005  Loss 29.6763 (28.2764)	Batch-Time 0.82 (0.86)	
2025-12-30 16:23:08,727 Epoch: [1][575/4425]	Iter 5000  lr 0.0005  Loss 31.2444 (28.2976)	Batch-Time 0.86 (0.85)	
2025-12-30 16:25:59,603 Epoch: [1][775/4425]	Iter 5200  lr 0.0005  Loss 27.6454 (28.1557)	Batch-Time 0.67 (0.85)	
2025-12-30 16:28:53,438 Epoch: [1][975/4425]	Iter 5400  lr 0.0005  Loss 29.2010 (28.0376)	Batch-Time 0.71 (0.85)	
2025-12-30 16:31:45,302 Epoch: [1][1175/4425]	Iter 5600  lr 0.0005  Loss 25.4171 (27.9943)	Batch-Time 0.75 (0.86)	
2025-12-30 16:34:36,174 Epoch: [1][1375/4425]	Iter 5800  lr 0.0005  Loss 29.9184 (27.9376)	Batch-Time 0.85 (0.86)	
2025-12-30 16:37:27,112 Epoch: [1][1575/4425]	Iter 6000  lr 0.0005  Loss 30.1125 (27.9199)	Batch-Time 0.72 (0.86)	
2025-12-30 16:40:16,357 Epoch: [1][1775/4425]	Iter 6200  lr 0.0005  Loss 23.2277 (27.8553)	Batch-Time 0.69 (0.85)	
2025-12-30 16:43:08,570 Epoch: [1][1975/4425]	Iter 6400  lr 0.0005  Loss 29.2924 (27.8196)	Batch-Time 0.73 (0.85)	
2025-12-30 16:45:53,763 Epoch: [1][2175/4425]	Iter 6600  lr 0.0005  Loss 26.7097 (27.7674)	Batch-Time 0.80 (0.85)	
2025-12-30 16:48:44,119 Epoch: [1][2375/4425]	Iter 6800  lr 0.0005  Loss 29.4037 (27.7278)	Batch-Time 0.83 (0.85)	
2025-12-30 16:51:31,569 Epoch: [1][2575/4425]	Iter 7000  lr 0.0005  Loss 27.2094 (27.6623)	Batch-Time 0.88 (0.85)	
2025-12-30 16:54:19,707 Epoch: [1][2775/4425]	Iter 7200  lr 0.0005  Loss 26.2379 (27.5857)	Batch-Time 0.77 (0.85)	
2025-12-30 16:57:07,734 Epoch: [1][2975/4425]	Iter 7400  lr 0.0005  Loss 27.8189 (27.5487)	Batch-Time 0.72 (0.85)	
2025-12-30 16:59:57,992 Epoch: [1][3175/4425]	Iter 7600  lr 0.0005  Loss 21.8648 (27.4640)	Batch-Time 0.72 (0.85)	
2025-12-30 17:02:51,291 Epoch: [1][3375/4425]	Iter 7800  lr 0.0005  Loss 28.2074 (27.4198)	Batch-Time 0.67 (0.85)	
2025-12-30 17:05:44,892 Epoch: [1][3575/4425]	Iter 8000  lr 0.0005  Loss 27.6577 (27.3712)	Batch-Time 0.70 (0.85)	
2025-12-30 17:08:47,757 Epoch: [1][3775/4425]	Iter 8200  lr 0.0005  Loss 112.8157 (31.6412)	Batch-Time 1.56 (0.86)	
2025-12-30 17:11:47,982 Epoch: [1][3975/4425]	Iter 8400  lr 0.0005  Loss 114.5601 (35.3796)	Batch-Time 0.89 (0.86)	
2025-12-30 17:14:50,838 Epoch: [1][4175/4425]	Iter 8600  lr 0.0005  Loss 98.3630 (38.8240)	Batch-Time 0.81 (0.86)	
2025-12-30 17:17:50,505 Epoch: [1][4375/4425]	Iter 8800  lr 0.0005  Loss 115.4831 (41.9405)	Batch-Time 0.78 (0.86)	
2025-12-30 17:18:36,942 Test: [0/196]		Batch-Time 2.064 (2.064)	
2025-12-30 17:19:37,486 Image to text (R@1, R@5, R@10): 51.8, 79.4, 87.5
2025-12-30 17:19:39,608 Text to image (R@1, R@5, R@10): 36.1, 65.4, 77.4
2025-12-30 17:19:39,608 Current rsum is 397.6
2025-12-30 17:19:39,614 Epoch: [1], Best rsum: 397.6
2025-12-30 17:22:01,783 Epoch: [2][150/4425]	Iter 9000  lr 0.0005  Loss 107.4227 (101.5299)	Batch-Time 0.88 (0.93)	
2025-12-30 17:25:01,793 Epoch: [2][350/4425]	Iter 9200  lr 0.0005  Loss 112.1376 (102.0181)	Batch-Time 0.75 (0.91)	
2025-12-30 17:28:05,577 Epoch: [2][550/4425]	Iter 9400  lr 0.0005  Loss 111.4678 (101.5253)	Batch-Time 0.78 (0.91)	
2025-12-30 17:31:04,916 Epoch: [2][750/4425]	Iter 9600  lr 0.0005  Loss 95.7593 (101.5757)	Batch-Time 1.11 (0.91)	
2025-12-30 17:34:08,323 Epoch: [2][950/4425]	Iter 9800  lr 0.0005  Loss 103.2060 (101.4752)	Batch-Time 0.82 (0.91)	
2025-12-30 17:37:11,999 Epoch: [2][1150/4425]	Iter 10000  lr 0.0005  Loss 92.1400 (101.3335)	Batch-Time 0.83 (0.91)	
2025-12-30 17:40:14,571 Epoch: [2][1350/4425]	Iter 10200  lr 0.0005  Loss 104.9906 (101.0684)	Batch-Time 0.98 (0.91)	
2025-12-30 17:43:20,117 Epoch: [2][1550/4425]	Iter 10400  lr 0.0005  Loss 102.2758 (100.8990)	Batch-Time 0.84 (0.91)	
2025-12-30 17:46:21,686 Epoch: [2][1750/4425]	Iter 10600  lr 0.0005  Loss 118.7335 (100.9373)	Batch-Time 1.40 (0.91)	
2025-12-30 17:49:21,898 Epoch: [2][1950/4425]	Iter 10800  lr 0.0005  Loss 118.6544 (100.8252)	Batch-Time 1.32 (0.91)	
2025-12-30 17:52:24,827 Epoch: [2][2150/4425]	Iter 11000  lr 0.0005  Loss 103.6022 (100.7749)	Batch-Time 0.83 (0.91)	
2025-12-30 17:55:29,404 Epoch: [2][2350/4425]	Iter 11200  lr 0.0005  Loss 101.1971 (100.6701)	Batch-Time 1.18 (0.91)	
2025-12-30 17:58:34,038 Epoch: [2][2550/4425]	Iter 11400  lr 0.0005  Loss 99.2037 (100.7014)	Batch-Time 0.87 (0.91)	
2025-12-30 18:01:36,240 Epoch: [2][2750/4425]	Iter 11600  lr 0.0005  Loss 99.6660 (100.7023)	Batch-Time 0.89 (0.91)	
2025-12-30 18:04:37,067 Epoch: [2][2950/4425]	Iter 11800  lr 0.0005  Loss 110.3874 (100.5979)	Batch-Time 0.73 (0.91)	
2025-12-30 18:07:37,430 Epoch: [2][3150/4425]	Iter 12000  lr 0.0005  Loss 98.6875 (100.4733)	Batch-Time 0.80 (0.91)	
2025-12-30 18:10:42,768 Epoch: [2][3350/4425]	Iter 12200  lr 0.0005  Loss 83.6848 (100.3287)	Batch-Time 0.93 (0.91)	
2025-12-30 18:13:44,292 Epoch: [2][3550/4425]	Iter 12400  lr 0.0005  Loss 88.5444 (100.2419)	Batch-Time 1.04 (0.91)	
2025-12-30 18:16:48,429 Epoch: [2][3750/4425]	Iter 12600  lr 0.0005  Loss 87.7356 (100.0987)	Batch-Time 0.79 (0.91)	
2025-12-30 18:19:47,692 Epoch: [2][3950/4425]	Iter 12800  lr 0.0005  Loss 80.3722 (100.0098)	Batch-Time 0.80 (0.91)	
2025-12-30 18:22:49,893 Epoch: [2][4150/4425]	Iter 13000  lr 0.0005  Loss 88.6318 (99.8416)	Batch-Time 0.89 (0.91)	
2025-12-30 18:26:50,701 Epoch: [2][4350/4425]	Iter 13200  lr 0.0005  Loss 81.9393 (99.7846)	Batch-Time 0.85 (0.93)	
2025-12-30 18:28:11,068 Test: [0/196]		Batch-Time 9.932 (9.931)	
2025-12-30 18:29:11,983 Image to text (R@1, R@5, R@10): 52.8, 81.2, 89.5
2025-12-30 18:29:14,494 Text to image (R@1, R@5, R@10): 36.8, 66.9, 78.4
2025-12-30 18:29:14,494 Current rsum is 405.7
2025-12-30 18:29:14,501 Epoch: [2], Best rsum: 405.7
2025-12-30 18:31:16,746 Epoch: [3][125/4425]	Iter 13400  lr 0.0005  Loss 93.1701 (93.4418)	Batch-Time 0.84 (0.95)	
2025-12-30 18:34:22,584 Epoch: [3][325/4425]	Iter 13600  lr 0.0005  Loss 79.2962 (93.4919)	Batch-Time 0.94 (0.94)	
2025-12-30 18:37:27,348 Epoch: [3][525/4425]	Iter 13800  lr 0.0005  Loss 107.9239 (93.6305)	Batch-Time 0.80 (0.93)	
2025-12-30 18:40:30,209 Epoch: [3][725/4425]	Iter 14000  lr 0.0005  Loss 85.6813 (93.7295)	Batch-Time 0.83 (0.93)	
2025-12-30 18:43:31,506 Epoch: [3][925/4425]	Iter 14200  lr 0.0005  Loss 85.2669 (93.6868)	Batch-Time 0.84 (0.92)	
2025-12-30 18:46:35,960 Epoch: [3][1125/4425]	Iter 14400  lr 0.0005  Loss 85.5328 (93.8283)	Batch-Time 0.78 (0.92)	
2025-12-30 18:49:37,375 Epoch: [3][1325/4425]	Iter 14600  lr 0.0005  Loss 94.3184 (93.9812)	Batch-Time 0.92 (0.92)	
2025-12-30 18:52:40,500 Epoch: [3][1525/4425]	Iter 14800  lr 0.0005  Loss 107.3783 (94.0962)	Batch-Time 0.91 (0.92)	
2025-12-30 18:55:41,996 Epoch: [3][1725/4425]	Iter 15000  lr 0.0005  Loss 92.8233 (94.2089)	Batch-Time 1.11 (0.92)	
2025-12-30 18:58:41,864 Epoch: [3][1925/4425]	Iter 15200  lr 0.0005  Loss 99.9656 (94.1325)	Batch-Time 0.83 (0.92)	
2025-12-30 19:01:44,825 Epoch: [3][2125/4425]	Iter 15400  lr 0.0005  Loss 89.1715 (94.2345)	Batch-Time 0.83 (0.92)	
2025-12-30 19:04:44,975 Epoch: [3][2325/4425]	Iter 15600  lr 0.0005  Loss 87.0059 (94.2639)	Batch-Time 0.85 (0.91)	
2025-12-30 19:07:48,877 Epoch: [3][2525/4425]	Iter 15800  lr 0.0005  Loss 91.3592 (94.2114)	Batch-Time 0.84 (0.92)	
2025-12-30 19:10:49,589 Epoch: [3][2725/4425]	Iter 16000  lr 0.0005  Loss 68.7481 (94.1487)	Batch-Time 0.81 (0.91)	
2025-12-30 19:13:53,577 Epoch: [3][2925/4425]	Iter 16200  lr 0.0005  Loss 101.9886 (94.0194)	Batch-Time 0.89 (0.91)	
2025-12-30 19:16:56,215 Epoch: [3][3125/4425]	Iter 16400  lr 0.0005  Loss 78.8394 (93.9215)	Batch-Time 0.82 (0.91)	
2025-12-30 19:20:00,713 Epoch: [3][3325/4425]	Iter 16600  lr 0.0005  Loss 85.0315 (93.9422)	Batch-Time 0.97 (0.92)	
2025-12-30 19:23:05,887 Epoch: [3][3525/4425]	Iter 16800  lr 0.0005  Loss 101.7257 (93.8893)	Batch-Time 0.70 (0.92)	
2025-12-30 19:26:13,868 Epoch: [3][3725/4425]	Iter 17000  lr 0.0005  Loss 86.3487 (93.8818)	Batch-Time 0.77 (0.92)	
2025-12-30 19:29:15,363 Epoch: [3][3925/4425]	Iter 17200  lr 0.0005  Loss 85.2916 (93.8271)	Batch-Time 0.80 (0.92)	
2025-12-30 19:32:17,398 Epoch: [3][4125/4425]	Iter 17400  lr 0.0005  Loss 83.9960 (93.8340)	Batch-Time 0.93 (0.92)	
2025-12-30 19:35:17,848 Epoch: [3][4325/4425]	Iter 17600  lr 0.0005  Loss 94.6314 (93.8176)	Batch-Time 0.91 (0.92)	
2025-12-30 19:37:15,363 Test: [0/196]		Batch-Time 24.171 (24.168)	
2025-12-30 19:39:56,349 Image to text (R@1, R@5, R@10): 54.8, 81.8, 89.7
2025-12-30 19:39:58,321 Text to image (R@1, R@5, R@10): 38.7, 68.3, 79.8
2025-12-30 19:39:58,321 Current rsum is 413.0
2025-12-30 19:39:58,325 Epoch: [3], Best rsum: 413.0
2025-12-30 19:41:38,043 Epoch: [4][100/4425]	Iter 17800  lr 0.0005  Loss 89.4911 (90.7718)	Batch-Time 0.94 (0.96)	
2025-12-30 19:44:40,428 Epoch: [4][300/4425]	Iter 18000  lr 0.0005  Loss 96.3071 (90.5123)	Batch-Time 1.04 (0.93)	
2025-12-30 19:47:44,119 Epoch: [4][500/4425]	Iter 18200  lr 0.0005  Loss 95.3778 (89.7353)	Batch-Time 0.82 (0.92)	
2025-12-30 19:50:51,700 Epoch: [4][700/4425]	Iter 18400  lr 0.0005  Loss 99.3722 (89.6594)	Batch-Time 0.83 (0.93)	
2025-12-30 19:53:54,969 Epoch: [4][900/4425]	Iter 18600  lr 0.0005  Loss 82.4015 (89.6279)	Batch-Time 0.93 (0.93)	
2025-12-30 19:56:56,285 Epoch: [4][1100/4425]	Iter 18800  lr 0.0005  Loss 101.6950 (89.8482)	Batch-Time 0.87 (0.92)	
2025-12-30 20:00:01,450 Epoch: [4][1300/4425]	Iter 19000  lr 0.0005  Loss 99.4700 (89.8168)	Batch-Time 1.15 (0.92)	
2025-12-30 20:03:02,607 Epoch: [4][1500/4425]	Iter 19200  lr 0.0005  Loss 82.7503 (89.8092)	Batch-Time 0.84 (0.92)	
2025-12-30 20:06:03,452 Epoch: [4][1700/4425]	Iter 19400  lr 0.0005  Loss 90.2508 (89.6912)	Batch-Time 0.98 (0.92)	
2025-12-30 20:34:50,769 Epoch: [4][1900/4425]	Iter 19600  lr 0.0005  Loss 98.1224 (89.7780)	Batch-Time 0.95 (1.73)	
2025-12-30 20:37:53,121 Epoch: [4][2100/4425]	Iter 19800  lr 0.0005  Loss 80.2175 (89.7715)	Batch-Time 0.96 (1.65)	
