2025-12-29 19:30:21,474 Namespace(data_path='data/', dataset='f30k', margin=0.2, num_epochs=30, batch_size=128, embed_size=1024, grad_clip=2.0, learning_rate=0.0005, workers=8, log_step=200, val_step=500, logger_name='runs/f30k_test', model_name='runs/f30k_test', max_violation=False, img_dim=2048, no_imgnorm=False, no_txtnorm=False, vse_mean_warmup_epochs=1, multi_gpu=0, size_augment=1, mask_repeat=1, save_results=1, gpu_id=0, bert_path='/model/darkpromise/VSE_backbone/bert-base-uncased', lr_schedules=[15, 25], decay_rate=0.1, base_loss='trip', gnn_loss='trip', warmup=8000, residual_weight=0.8, num_layers_enc=1, nhead=16, dropout=0.1, graph_lr_factor=1.0, mask_weight=1.0, threshold=0.5, topk=10, reg_loss_weight=10, norm_input=1, cross_loss=1)
2025-12-29 19:31:16,631 Number of images for train-set: 29000
2025-12-29 19:31:23,346 Log saving path: runs/f30k_test
2025-12-29 19:31:23,346 Models saving path: runs/f30k_test
2025-12-29 19:31:23,346 image encoder trainable parameters: 9.52M
2025-12-29 19:31:23,347 txt encoder trainable parameters: 111.17M
2025-12-29 19:31:23,347 criterion trainable parameters: 6.01M
2025-12-29 19:35:27,295 Epoch: [0][200/1132]	Iter 200  lr 0.0005  Loss 52.1675 (52.1424)	Batch-Time 1.18 (1.22)	
2025-12-29 19:39:18,876 Epoch: [0][400/1132]	Iter 400  lr 0.0005  Loss 48.1395 (51.3370)	Batch-Time 1.44 (1.19)	
2025-12-29 19:43:14,113 Epoch: [0][600/1132]	Iter 600  lr 0.0005  Loss 40.1976 (49.6104)	Batch-Time 1.42 (1.18)	
2025-12-29 19:47:09,555 Epoch: [0][800/1132]	Iter 800  lr 0.0005  Loss 37.4325 (47.7242)	Batch-Time 0.86 (1.18)	
2025-12-29 19:51:01,422 Epoch: [0][1000/1132]	Iter 1000  lr 0.0005  Loss 41.8860 (46.1048)	Batch-Time 1.20 (1.18)	
2025-12-29 19:53:35,363 Test: [0/40]		Batch-Time 1.100 (1.100)	
2025-12-29 19:53:50,831 Image to text (R@1, R@5, R@10): 66.7, 88.7, 95.4
2025-12-29 19:53:50,916 Text to image (R@1, R@5, R@10): 48.6, 78.6, 86.7
2025-12-29 19:53:50,916 Current rsum is 464.8
2025-12-29 19:53:50,917 Epoch: [0], Best rsum: 464.8
2025-12-29 19:55:18,546 Epoch: [1][68/1132]	Iter 1200  lr 0.0005  Loss 33.5108 (35.3834)	Batch-Time 1.12 (1.24)	
2025-12-29 19:59:11,505 Epoch: [1][268/1132]	Iter 1400  lr 0.0005  Loss 36.7825 (34.7966)	Batch-Time 0.98 (1.18)	
2025-12-29 20:03:06,343 Epoch: [1][468/1132]	Iter 1600  lr 0.0005  Loss 30.3566 (34.4543)	Batch-Time 1.10 (1.18)	
2025-12-29 20:06:56,129 Epoch: [1][668/1132]	Iter 1800  lr 0.0005  Loss 29.5111 (34.1234)	Batch-Time 1.12 (1.17)	
2025-12-29 20:10:50,448 Epoch: [1][868/1132]	Iter 2000  lr 0.0005  Loss 32.1421 (33.7024)	Batch-Time 1.22 (1.17)	
2025-12-29 20:14:46,695 Epoch: [1][1068/1132]	Iter 2200  lr 0.0005  Loss 35.8925 (33.3595)	Batch-Time 1.01 (1.17)	
2025-12-29 20:16:02,064 Test: [0/40]		Batch-Time 1.468 (1.468)	
2025-12-29 20:16:17,571 Image to text (R@1, R@5, R@10): 76.5, 92.2, 96.7
2025-12-29 20:16:17,655 Text to image (R@1, R@5, R@10): 54.9, 82.8, 89.7
2025-12-29 20:16:17,655 Current rsum is 492.8
2025-12-29 20:16:17,656 Epoch: [1], Best rsum: 492.8
2025-12-29 20:18:59,849 Epoch: [2][136/1132]	Iter 2400  lr 0.0005  Loss 23.6345 (29.6092)	Batch-Time 1.18 (1.17)	
2025-12-29 20:22:59,912 Epoch: [2][336/1132]	Iter 2600  lr 0.0005  Loss 31.9596 (29.3824)	Batch-Time 1.19 (1.19)	
2025-12-29 20:26:53,455 Epoch: [2][536/1132]	Iter 2800  lr 0.0005  Loss 26.6263 (29.2462)	Batch-Time 0.93 (1.18)	
2025-12-29 20:30:44,461 Epoch: [2][736/1132]	Iter 3000  lr 0.0005  Loss 30.5460 (29.1658)	Batch-Time 1.51 (1.17)	
2025-12-29 20:34:39,210 Epoch: [2][936/1132]	Iter 3200  lr 0.0005  Loss 30.8581 (29.0789)	Batch-Time 1.26 (1.17)	
2025-12-29 20:38:27,927 Test: [0/40]		Batch-Time 1.415 (1.415)	
2025-12-29 20:38:43,484 Image to text (R@1, R@5, R@10): 76.1, 94.0, 96.8
2025-12-29 20:38:43,569 Text to image (R@1, R@5, R@10): 56.2, 83.7, 90.2
2025-12-29 20:38:43,569 Current rsum is 497.0
2025-12-29 20:38:43,570 Epoch: [2], Best rsum: 497.0
2025-12-29 20:38:52,712 Epoch: [3][4/1132]	Iter 3400  lr 0.0005  Loss 29.9242 (27.4874)	Batch-Time 1.00 (1.48)	
2025-12-29 20:42:46,356 Epoch: [3][204/1132]	Iter 3600  lr 0.0005  Loss 29.0384 (26.4168)	Batch-Time 0.98 (1.17)	
2025-12-29 20:46:37,788 Epoch: [3][404/1132]	Iter 3800  lr 0.0005  Loss 28.9145 (26.6558)	Batch-Time 1.05 (1.17)	
2025-12-29 20:50:40,127 Epoch: [3][604/1132]	Iter 4000  lr 0.0005  Loss 24.4359 (26.6568)	Batch-Time 0.98 (1.18)	
2025-12-29 20:54:37,148 Epoch: [3][804/1132]	Iter 4200  lr 0.0005  Loss 25.9713 (26.5093)	Batch-Time 1.12 (1.18)	
2025-12-29 20:58:28,394 Epoch: [3][1004/1132]	Iter 4400  lr 0.0005  Loss 29.7486 (26.4784)	Batch-Time 0.88 (1.18)	
2025-12-29 21:00:58,216 Test: [0/40]		Batch-Time 1.338 (1.338)	
2025-12-29 21:01:13,775 Image to text (R@1, R@5, R@10): 77.5, 93.1, 96.9
2025-12-29 21:01:13,859 Text to image (R@1, R@5, R@10): 57.6, 84.0, 90.7
2025-12-29 21:01:13,859 Current rsum is 499.8
2025-12-29 21:01:13,860 Epoch: [3], Best rsum: 499.8
2025-12-29 21:02:43,934 Epoch: [4][72/1132]	Iter 4600  lr 0.0005  Loss 25.7346 (24.4610)	Batch-Time 1.30 (1.21)	
2025-12-29 21:06:37,381 Epoch: [4][272/1132]	Iter 4800  lr 0.0005  Loss 23.6609 (24.2475)	Batch-Time 1.36 (1.18)	
2025-12-29 21:10:27,039 Epoch: [4][472/1132]	Iter 5000  lr 0.0005  Loss 27.3187 (24.2698)	Batch-Time 1.12 (1.17)	
2025-12-29 21:14:18,432 Epoch: [4][672/1132]	Iter 5200  lr 0.0005  Loss 24.4205 (24.2205)	Batch-Time 1.28 (1.16)	
2025-12-29 21:18:10,655 Epoch: [4][872/1132]	Iter 5400  lr 0.0005  Loss 24.6099 (24.2255)	Batch-Time 0.90 (1.16)	
2025-12-29 21:22:08,944 Epoch: [4][1072/1132]	Iter 5600  lr 0.0005  Loss 23.5528 (24.2197)	Batch-Time 1.01 (1.17)	
2025-12-29 21:23:24,416 Test: [0/40]		Batch-Time 1.304 (1.304)	
2025-12-29 21:23:40,099 Image to text (R@1, R@5, R@10): 78.7, 94.8, 97.0
2025-12-29 21:23:40,204 Text to image (R@1, R@5, R@10): 59.5, 85.6, 91.3
2025-12-29 21:23:40,204 Current rsum is 506.8
2025-12-29 21:23:40,206 Epoch: [4], Best rsum: 506.8
2025-12-29 21:26:27,061 Epoch: [5][140/1132]	Iter 5800  lr 0.0005  Loss 23.3160 (22.4740)	Batch-Time 1.04 (1.17)	
2025-12-29 21:30:24,439 Epoch: [5][340/1132]	Iter 6000  lr 0.0005  Loss 22.8586 (22.6813)	Batch-Time 1.26 (1.18)	
2025-12-29 21:34:17,619 Epoch: [5][540/1132]	Iter 6200  lr 0.0005  Loss 21.2114 (22.6764)	Batch-Time 1.09 (1.17)	
2025-12-29 21:38:09,449 Epoch: [5][740/1132]	Iter 6400  lr 0.0005  Loss 18.1105 (22.6190)	Batch-Time 1.12 (1.17)	
2025-12-29 21:42:01,140 Epoch: [5][940/1132]	Iter 6600  lr 0.0005  Loss 20.0536 (22.6082)	Batch-Time 1.18 (1.17)	
2025-12-29 21:45:47,701 Test: [0/40]		Batch-Time 1.465 (1.465)	
2025-12-29 21:46:03,278 Image to text (R@1, R@5, R@10): 78.6, 95.0, 98.0
2025-12-29 21:46:03,362 Text to image (R@1, R@5, R@10): 59.2, 85.3, 91.3
2025-12-29 21:46:03,362 Current rsum is 507.4
2025-12-29 21:46:03,363 Epoch: [5], Best rsum: 507.4
2025-12-29 21:46:16,601 Epoch: [6][8/1132]	Iter 6800  lr 0.0005  Loss 20.5968 (21.5469)	Batch-Time 1.03 (1.25)	
2025-12-29 21:50:10,670 Epoch: [6][208/1132]	Iter 7000  lr 0.0005  Loss 21.5422 (21.0701)	Batch-Time 1.15 (1.17)	
2025-12-29 21:54:01,723 Epoch: [6][408/1132]	Iter 7200  lr 0.0005  Loss 25.3193 (21.2075)	Batch-Time 1.28 (1.16)	
2025-12-29 21:57:54,278 Epoch: [6][608/1132]	Iter 7400  lr 0.0005  Loss 20.1861 (21.3570)	Batch-Time 1.01 (1.16)	
2025-12-29 22:01:52,036 Epoch: [6][808/1132]	Iter 7600  lr 0.0005  Loss 24.2574 (21.3977)	Batch-Time 1.15 (1.17)	
2025-12-29 22:05:49,106 Epoch: [6][1008/1132]	Iter 7800  lr 0.0005  Loss 21.5626 (21.4346)	Batch-Time 1.56 (1.17)	
2025-12-29 22:08:16,523 Test: [0/40]		Batch-Time 1.573 (1.573)	
2025-12-29 22:08:32,035 Image to text (R@1, R@5, R@10): 80.0, 94.9, 97.3
2025-12-29 22:08:32,119 Text to image (R@1, R@5, R@10): 60.2, 85.7, 92.1
2025-12-29 22:08:32,119 Current rsum is 510.2
2025-12-29 22:08:32,121 Epoch: [6], Best rsum: 510.2
2025-12-29 22:10:09,491 Epoch: [7][76/1132]	Iter 8000  lr 0.0005  Loss 20.0780 (19.7995)	Batch-Time 0.86 (1.24)	
2025-12-29 22:14:15,468 Epoch: [7][276/1132]	Iter 8200  lr 0.0005  Loss 82.6631 (64.3355)	Batch-Time 1.70 (1.23)	
2025-12-29 22:18:22,666 Epoch: [7][476/1132]	Iter 8400  lr 0.0005  Loss 87.0116 (72.0017)	Batch-Time 0.99 (1.23)	
2025-12-29 22:22:32,907 Epoch: [7][676/1132]	Iter 8600  lr 0.0005  Loss 81.7536 (74.6484)	Batch-Time 1.19 (1.24)	
2025-12-29 22:26:38,719 Epoch: [7][876/1132]	Iter 8800  lr 0.0005  Loss 79.6949 (76.1755)	Batch-Time 1.12 (1.24)	
2025-12-29 22:30:40,718 Epoch: [7][1076/1132]	Iter 9000  lr 0.0005  Loss 77.8320 (77.1535)	Batch-Time 0.96 (1.23)	
2025-12-29 22:31:52,009 Test: [0/40]		Batch-Time 1.673 (1.673)	
2025-12-29 22:32:07,594 Image to text (R@1, R@5, R@10): 81.2, 95.7, 98.0
2025-12-29 22:32:07,678 Text to image (R@1, R@5, R@10): 61.3, 86.7, 91.8
2025-12-29 22:32:07,678 Current rsum is 514.8
2025-12-29 22:32:07,680 Epoch: [7], Best rsum: 514.8
2025-12-29 22:35:08,351 Epoch: [8][144/1132]	Iter 9200  lr 0.0005  Loss 73.7395 (74.2826)	Batch-Time 1.02 (1.23)	
2025-12-29 22:39:14,699 Epoch: [8][344/1132]	Iter 9400  lr 0.0005  Loss 83.7063 (75.6685)	Batch-Time 1.11 (1.23)	
2025-12-29 22:43:21,704 Epoch: [8][544/1132]	Iter 9600  lr 0.0005  Loss 81.2506 (75.5174)	Batch-Time 0.94 (1.23)	
2025-12-29 22:47:29,732 Epoch: [8][744/1132]	Iter 9800  lr 0.0005  Loss 71.6701 (75.8598)	Batch-Time 1.41 (1.24)	
2025-12-29 22:51:36,742 Epoch: [8][944/1132]	Iter 10000  lr 0.0005  Loss 68.9439 (75.9431)	Batch-Time 1.14 (1.24)	
2025-12-29 22:55:30,201 Test: [0/40]		Batch-Time 1.856 (1.855)	
2025-12-29 22:55:45,778 Image to text (R@1, R@5, R@10): 79.0, 94.1, 97.6
2025-12-29 22:55:45,861 Text to image (R@1, R@5, R@10): 60.3, 85.9, 91.6
2025-12-29 22:55:45,861 Current rsum is 508.5
2025-12-29 22:55:45,862 Epoch: [8], Best rsum: 514.8
2025-12-29 22:56:01,660 Epoch: [9][12/1132]	Iter 10200  lr 0.0005  Loss 78.3570 (73.2953)	Batch-Time 1.04 (1.32)	
2025-12-29 23:00:07,236 Epoch: [9][212/1132]	Iter 10400  lr 0.0005  Loss 88.3702 (73.0289)	Batch-Time 1.22 (1.23)	
2025-12-29 23:04:17,330 Epoch: [9][412/1132]	Iter 10600  lr 0.0005  Loss 93.0084 (72.8027)	Batch-Time 1.08 (1.24)	
2025-12-29 23:08:22,295 Epoch: [9][612/1132]	Iter 10800  lr 0.0005  Loss 76.0734 (72.5290)	Batch-Time 1.00 (1.24)	
2025-12-29 23:12:32,046 Epoch: [9][812/1132]	Iter 11000  lr 0.0005  Loss 80.2825 (72.5330)	Batch-Time 1.35 (1.24)	
2025-12-29 23:16:39,371 Epoch: [9][1012/1132]	Iter 11200  lr 0.0005  Loss 68.9190 (72.5914)	Batch-Time 1.18 (1.24)	
2025-12-29 23:19:08,405 Test: [0/40]		Batch-Time 1.805 (1.805)	
2025-12-29 23:19:23,962 Image to text (R@1, R@5, R@10): 82.3, 95.1, 97.7
2025-12-29 23:19:24,046 Text to image (R@1, R@5, R@10): 61.3, 86.4, 91.6
2025-12-29 23:19:24,046 Current rsum is 514.3
2025-12-29 23:19:24,047 Epoch: [9], Best rsum: 514.8
2025-12-29 23:21:06,472 Epoch: [10][80/1132]	Iter 11400  lr 0.0005  Loss 68.1146 (67.8989)	Batch-Time 1.24 (1.28)	
2025-12-29 23:25:13,084 Epoch: [10][280/1132]	Iter 11600  lr 0.0005  Loss 76.8059 (67.8076)	Batch-Time 1.28 (1.25)	
2025-12-29 23:29:17,108 Epoch: [10][480/1132]	Iter 11800  lr 0.0005  Loss 62.7956 (68.3184)	Batch-Time 1.08 (1.24)	
2025-12-29 23:33:28,578 Epoch: [10][680/1132]	Iter 12000  lr 0.0005  Loss 74.9809 (68.5360)	Batch-Time 1.14 (1.24)	
2025-12-29 23:37:37,440 Epoch: [10][880/1132]	Iter 12200  lr 0.0005  Loss 76.6749 (68.5667)	Batch-Time 1.30 (1.24)	
2025-12-29 23:41:43,724 Epoch: [10][1080/1132]	Iter 12400  lr 0.0005  Loss 67.2309 (68.6955)	Batch-Time 1.11 (1.24)	
2025-12-29 23:42:49,954 Test: [0/40]		Batch-Time 1.856 (1.856)	
2025-12-29 23:43:05,644 Image to text (R@1, R@5, R@10): 81.9, 95.6, 97.8
2025-12-29 23:43:05,750 Text to image (R@1, R@5, R@10): 60.9, 86.4, 91.6
2025-12-29 23:43:05,750 Current rsum is 514.2
2025-12-29 23:43:05,751 Epoch: [10], Best rsum: 514.8
2025-12-29 23:46:15,804 Epoch: [11][148/1132]	Iter 12600  lr 0.0005  Loss 70.4400 (63.8575)	Batch-Time 1.61 (1.28)	
2025-12-29 23:50:23,517 Epoch: [11][348/1132]	Iter 12800  lr 0.0005  Loss 70.9553 (64.3611)	Batch-Time 1.27 (1.26)	
2025-12-29 23:54:27,081 Epoch: [11][548/1132]	Iter 13000  lr 0.0005  Loss 59.1928 (64.6959)	Batch-Time 1.35 (1.24)	
2025-12-29 23:58:34,440 Epoch: [11][748/1132]	Iter 13200  lr 0.0005  Loss 53.8340 (64.7769)	Batch-Time 1.10 (1.24)	
2025-12-30 00:02:41,221 Epoch: [11][948/1132]	Iter 13400  lr 0.0005  Loss 60.3595 (64.9404)	Batch-Time 1.31 (1.24)	
2025-12-30 00:06:31,346 Test: [0/40]		Batch-Time 2.090 (2.089)	
2025-12-30 00:06:46,987 Image to text (R@1, R@5, R@10): 81.1, 95.9, 97.7
2025-12-30 00:06:47,092 Text to image (R@1, R@5, R@10): 61.7, 86.0, 91.8
2025-12-30 00:06:47,092 Current rsum is 514.2
2025-12-30 00:06:47,094 Epoch: [11], Best rsum: 514.8
2025-12-30 00:07:08,428 Epoch: [12][16/1132]	Iter 13600  lr 0.0005  Loss 55.9328 (61.3987)	Batch-Time 1.18 (1.33)	
2025-12-30 00:11:16,866 Epoch: [12][216/1132]	Iter 13800  lr 0.0005  Loss 69.5848 (61.6784)	Batch-Time 1.30 (1.25)	
2025-12-30 00:15:23,722 Epoch: [12][416/1132]	Iter 14000  lr 0.0005  Loss 60.5982 (61.6738)	Batch-Time 0.94 (1.24)	
2025-12-30 00:19:27,685 Epoch: [12][616/1132]	Iter 14200  lr 0.0005  Loss 68.0671 (62.1389)	Batch-Time 1.02 (1.23)	
2025-12-30 00:23:36,365 Epoch: [12][816/1132]	Iter 14400  lr 0.0005  Loss 52.8587 (62.4610)	Batch-Time 1.10 (1.24)	
2025-12-30 00:27:42,211 Epoch: [12][1016/1132]	Iter 14600  lr 0.0005  Loss 60.5381 (62.5407)	Batch-Time 1.33 (1.24)	
2025-12-30 00:30:10,588 Test: [0/40]		Batch-Time 2.104 (2.104)	
2025-12-30 00:30:26,243 Image to text (R@1, R@5, R@10): 80.5, 96.0, 97.8
2025-12-30 00:30:26,327 Text to image (R@1, R@5, R@10): 60.9, 86.1, 91.7
2025-12-30 00:30:26,327 Current rsum is 513.1
2025-12-30 00:30:26,328 Epoch: [12], Best rsum: 514.8
2025-12-30 00:32:10,246 Epoch: [13][84/1132]	Iter 14800  lr 0.0005  Loss 46.8873 (57.8412)	Batch-Time 1.25 (1.24)	
2025-12-30 00:36:20,592 Epoch: [13][284/1132]	Iter 15000  lr 0.0005  Loss 56.5623 (59.1992)	Batch-Time 0.97 (1.25)	
2025-12-30 00:40:27,688 Epoch: [13][484/1132]	Iter 15200  lr 0.0005  Loss 48.1750 (59.4793)	Batch-Time 1.44 (1.24)	
2025-12-30 00:44:35,947 Epoch: [13][684/1132]	Iter 15400  lr 0.0005  Loss 65.8493 (59.6277)	Batch-Time 1.35 (1.24)	
2025-12-30 00:48:45,053 Epoch: [13][884/1132]	Iter 15600  lr 0.0005  Loss 53.2991 (59.6953)	Batch-Time 1.07 (1.24)	
2025-12-30 00:52:49,190 Epoch: [13][1084/1132]	Iter 15800  lr 0.0005  Loss 64.6096 (59.9476)	Batch-Time 1.10 (1.24)	
2025-12-30 00:53:51,873 Test: [0/40]		Batch-Time 2.308 (2.308)	
2025-12-30 00:54:07,507 Image to text (R@1, R@5, R@10): 79.0, 95.2, 97.8
2025-12-30 00:54:07,591 Text to image (R@1, R@5, R@10): 60.9, 85.4, 91.5
2025-12-30 00:54:07,591 Current rsum is 509.8
2025-12-30 00:54:07,592 Epoch: [13], Best rsum: 514.8
2025-12-30 00:57:21,492 Epoch: [14][152/1132]	Iter 16000  lr 0.0005  Loss 56.3918 (55.4882)	Batch-Time 1.00 (1.28)	
2025-12-30 01:01:26,650 Epoch: [14][352/1132]	Iter 16200  lr 0.0005  Loss 54.1160 (56.3969)	Batch-Time 1.30 (1.25)	
2025-12-30 01:05:35,057 Epoch: [14][552/1132]	Iter 16400  lr 0.0005  Loss 62.5617 (57.0658)	Batch-Time 1.13 (1.25)	
2025-12-30 01:09:47,960 Epoch: [14][752/1132]	Iter 16600  lr 0.0005  Loss 64.4097 (57.3516)	Batch-Time 1.11 (1.25)	
2025-12-30 01:13:47,463 Epoch: [14][952/1132]	Iter 16800  lr 0.0005  Loss 55.7453 (57.3234)	Batch-Time 1.07 (1.24)	
2025-12-30 01:17:29,219 Test: [0/40]		Batch-Time 2.456 (2.456)	
2025-12-30 01:17:44,847 Image to text (R@1, R@5, R@10): 80.5, 94.8, 97.3
2025-12-30 01:17:44,932 Text to image (R@1, R@5, R@10): 61.2, 85.9, 91.6
2025-12-30 01:17:44,932 Current rsum is 511.3
2025-12-30 01:17:44,934 Epoch: [14], Best rsum: 514.8
2025-12-30 01:17:44,935 Current epoch num is 15, decrease all lr by 10
2025-12-30 01:17:44,935 new lr: 5e-05
2025-12-30 01:17:44,935 new lr: 5e-06
2025-12-30 01:17:44,935 new lr: 5e-05
2025-12-30 01:17:44,935 new lr: 5e-05
2025-12-30 01:18:12,257 Epoch: [15][20/1132]	Iter 17000  lr 5e-05  Loss 59.3092 (51.9642)	Batch-Time 1.18 (1.37)	
2025-12-30 01:22:22,832 Epoch: [15][220/1132]	Iter 17200  lr 5e-05  Loss 40.6811 (50.3049)	Batch-Time 1.23 (1.26)	
2025-12-30 01:26:27,405 Epoch: [15][420/1132]	Iter 17400  lr 5e-05  Loss 37.3179 (49.9571)	Batch-Time 1.06 (1.24)	
2025-12-30 01:30:30,797 Epoch: [15][620/1132]	Iter 17600  lr 5e-05  Loss 48.7163 (49.4755)	Batch-Time 1.24 (1.24)	
2025-12-30 01:34:39,455 Epoch: [15][820/1132]	Iter 17800  lr 5e-05  Loss 60.6946 (49.1154)	Batch-Time 1.50 (1.24)	
2025-12-30 01:38:43,607 Epoch: [15][1020/1132]	Iter 18000  lr 5e-05  Loss 56.7450 (48.7201)	Batch-Time 1.18 (1.23)	
2025-12-30 01:41:07,424 Test: [0/40]		Batch-Time 2.482 (2.482)	
2025-12-30 01:41:23,056 Image to text (R@1, R@5, R@10): 81.8, 95.6, 98.2
2025-12-30 01:41:23,140 Text to image (R@1, R@5, R@10): 62.5, 86.7, 92.1
2025-12-30 01:41:23,140 Current rsum is 516.9
2025-12-30 01:41:23,141 Epoch: [15], Best rsum: 516.9
2025-12-30 01:43:20,654 Epoch: [16][88/1132]	Iter 18200  lr 5e-05  Loss 44.1680 (46.3718)	Batch-Time 1.30 (1.30)	
2025-12-30 01:47:28,555 Epoch: [16][288/1132]	Iter 18400  lr 5e-05  Loss 50.4610 (46.0784)	Batch-Time 1.08 (1.26)	
2025-12-30 01:51:38,250 Epoch: [16][488/1132]	Iter 18600  lr 5e-05  Loss 37.5720 (46.2453)	Batch-Time 1.22 (1.25)	
2025-12-30 01:55:49,418 Epoch: [16][688/1132]	Iter 18800  lr 5e-05  Loss 47.1819 (46.2617)	Batch-Time 1.30 (1.25)	
2025-12-30 01:59:52,074 Epoch: [16][888/1132]	Iter 19000  lr 5e-05  Loss 41.5509 (45.9641)	Batch-Time 1.23 (1.25)	
2025-12-30 02:03:54,609 Epoch: [16][1088/1132]	Iter 19200  lr 5e-05  Loss 38.5622 (45.9449)	Batch-Time 1.11 (1.24)	
2025-12-30 02:04:52,190 Test: [0/40]		Batch-Time 2.493 (2.493)	
2025-12-30 02:05:07,890 Image to text (R@1, R@5, R@10): 82.0, 96.0, 98.2
2025-12-30 02:05:07,975 Text to image (R@1, R@5, R@10): 62.8, 86.7, 92.2
2025-12-30 02:05:07,975 Current rsum is 517.9
2025-12-30 02:05:07,977 Epoch: [16], Best rsum: 517.9
2025-12-30 02:08:26,562 Epoch: [17][156/1132]	Iter 19400  lr 5e-05  Loss 44.6120 (44.5113)	Batch-Time 1.05 (1.25)	
2025-12-30 02:12:36,014 Epoch: [17][356/1132]	Iter 19600  lr 5e-05  Loss 39.9061 (44.3395)	Batch-Time 1.32 (1.25)	
2025-12-30 02:16:41,532 Epoch: [17][556/1132]	Iter 19800  lr 5e-05  Loss 56.4885 (44.3709)	Batch-Time 1.18 (1.24)	
2025-12-30 02:20:54,588 Epoch: [17][756/1132]	Iter 20000  lr 5e-05  Loss 35.5068 (44.3872)	Batch-Time 1.30 (1.25)	
2025-12-30 02:25:03,716 Epoch: [17][956/1132]	Iter 20200  lr 5e-05  Loss 44.2353 (44.1203)	Batch-Time 1.36 (1.25)	
2025-12-30 02:28:43,417 Test: [0/40]		Batch-Time 2.934 (2.934)	
2025-12-30 02:28:59,254 Image to text (R@1, R@5, R@10): 81.8, 96.0, 98.0
2025-12-30 02:28:59,338 Text to image (R@1, R@5, R@10): 63.1, 86.9, 92.0
2025-12-30 02:28:59,338 Current rsum is 517.8
2025-12-30 02:28:59,340 Epoch: [17], Best rsum: 517.9
2025-12-30 02:29:31,995 Epoch: [18][24/1132]	Iter 20400  lr 5e-05  Loss 32.8668 (41.7830)	Batch-Time 1.23 (1.36)	
2025-12-30 02:33:42,742 Epoch: [18][224/1132]	Iter 20600  lr 5e-05  Loss 38.6222 (43.3478)	Batch-Time 1.21 (1.27)	
2025-12-30 02:37:51,561 Epoch: [18][424/1132]	Iter 20800  lr 5e-05  Loss 38.0876 (43.5724)	Batch-Time 1.55 (1.26)	
2025-12-30 02:41:59,104 Epoch: [18][624/1132]	Iter 21000  lr 5e-05  Loss 39.2377 (43.4919)	Batch-Time 1.22 (1.25)	
2025-12-30 02:46:09,070 Epoch: [18][824/1132]	Iter 21200  lr 5e-05  Loss 39.0377 (43.3159)	Batch-Time 1.22 (1.25)	
2025-12-30 02:50:11,131 Epoch: [18][1024/1132]	Iter 21400  lr 5e-05  Loss 36.0563 (43.2218)	Batch-Time 1.19 (1.24)	
2025-12-30 02:52:27,761 Test: [0/40]		Batch-Time 3.104 (3.103)	
2025-12-30 02:52:43,409 Image to text (R@1, R@5, R@10): 82.0, 96.2, 98.2
2025-12-30 02:52:43,494 Text to image (R@1, R@5, R@10): 63.1, 86.8, 91.9
2025-12-30 02:52:43,494 Current rsum is 518.2
2025-12-30 02:52:43,495 Epoch: [18], Best rsum: 518.2
2025-12-30 02:54:45,276 Epoch: [19][92/1132]	Iter 21600  lr 5e-05  Loss 40.7595 (43.4876)	Batch-Time 1.29 (1.29)	
2025-12-30 02:58:55,285 Epoch: [19][292/1132]	Iter 21800  lr 5e-05  Loss 43.7339 (42.2463)	Batch-Time 0.99 (1.26)	
2025-12-30 03:03:01,835 Epoch: [19][492/1132]	Iter 22000  lr 5e-05  Loss 36.5903 (42.4503)	Batch-Time 2.24 (1.25)	
2025-12-30 03:07:06,308 Epoch: [19][692/1132]	Iter 22200  lr 5e-05  Loss 45.2233 (42.3233)	Batch-Time 1.22 (1.24)	
2025-12-30 03:11:09,894 Epoch: [19][892/1132]	Iter 22400  lr 5e-05  Loss 36.6907 (42.3153)	Batch-Time 1.42 (1.24)	
2025-12-30 03:15:18,172 Epoch: [19][1092/1132]	Iter 22600  lr 5e-05  Loss 53.7248 (42.2377)	Batch-Time 1.24 (1.24)	
2025-12-30 03:16:14,447 Test: [0/40]		Batch-Time 2.809 (2.809)	
2025-12-30 03:16:30,105 Image to text (R@1, R@5, R@10): 82.0, 96.4, 98.4
2025-12-30 03:16:30,188 Text to image (R@1, R@5, R@10): 62.9, 86.7, 92.1
2025-12-30 03:16:30,188 Current rsum is 518.5
2025-12-30 03:16:30,190 Epoch: [19], Best rsum: 518.5
2025-12-30 03:19:57,860 Epoch: [20][160/1132]	Iter 22800  lr 5e-05  Loss 52.4790 (40.3182)	Batch-Time 1.52 (1.28)	
2025-12-30 03:24:07,561 Epoch: [20][360/1132]	Iter 23000  lr 5e-05  Loss 40.5094 (40.8297)	Batch-Time 0.89 (1.26)	
2025-12-30 03:28:16,026 Epoch: [20][560/1132]	Iter 23200  lr 5e-05  Loss 45.3459 (41.2819)	Batch-Time 1.26 (1.25)	
2025-12-30 03:32:13,602 Epoch: [20][760/1132]	Iter 23400  lr 5e-05  Loss 44.1308 (41.2230)	Batch-Time 1.14 (1.24)	
2025-12-30 03:36:26,132 Epoch: [20][960/1132]	Iter 23600  lr 5e-05  Loss 43.3459 (41.3398)	Batch-Time 1.42 (1.24)	
2025-12-30 03:40:02,873 Test: [0/40]		Batch-Time 3.141 (3.140)	
2025-12-30 03:40:18,540 Image to text (R@1, R@5, R@10): 82.1, 96.5, 98.0
2025-12-30 03:40:18,623 Text to image (R@1, R@5, R@10): 62.9, 86.7, 91.9
2025-12-30 03:40:18,623 Current rsum is 518.1
2025-12-30 03:40:18,624 Epoch: [20], Best rsum: 518.5
2025-12-30 03:40:57,580 Epoch: [21][28/1132]	Iter 23800  lr 5e-05  Loss 36.4020 (42.4098)	Batch-Time 1.00 (1.39)	
2025-12-30 03:45:08,086 Epoch: [21][228/1132]	Iter 24000  lr 5e-05  Loss 49.2240 (41.2322)	Batch-Time 1.05 (1.27)	
2025-12-30 03:49:17,217 Epoch: [21][428/1132]	Iter 24200  lr 5e-05  Loss 35.6129 (40.8917)	Batch-Time 1.11 (1.26)	
2025-12-30 03:53:17,029 Epoch: [21][628/1132]	Iter 24400  lr 5e-05  Loss 46.8168 (40.6411)	Batch-Time 0.96 (1.24)	
2025-12-30 03:57:26,350 Epoch: [21][828/1132]	Iter 24600  lr 5e-05  Loss 39.9502 (40.6897)	Batch-Time 1.26 (1.24)	
2025-12-30 04:01:35,494 Epoch: [21][1028/1132]	Iter 24800  lr 5e-05  Loss 35.0832 (40.7494)	Batch-Time 1.33 (1.24)	
2025-12-30 04:03:46,108 Test: [0/40]		Batch-Time 3.051 (3.051)	
2025-12-30 04:04:03,450 Image to text (R@1, R@5, R@10): 81.8, 96.3, 98.2
2025-12-30 04:04:03,533 Text to image (R@1, R@5, R@10): 63.1, 86.6, 92.1
2025-12-30 04:04:03,533 Current rsum is 518.0
2025-12-30 04:04:03,535 Epoch: [21], Best rsum: 518.5
2025-12-30 04:06:03,725 Epoch: [22][96/1132]	Iter 25000  lr 5e-05  Loss 39.5033 (40.1628)	Batch-Time 1.35 (1.25)	
2025-12-30 04:10:13,832 Epoch: [22][296/1132]	Iter 25200  lr 5e-05  Loss 42.8710 (39.9335)	Batch-Time 1.12 (1.25)	
2025-12-30 04:14:19,102 Epoch: [22][496/1132]	Iter 25400  lr 5e-05  Loss 42.5367 (40.1157)	Batch-Time 1.21 (1.24)	
2025-12-30 04:18:22,527 Epoch: [22][696/1132]	Iter 25600  lr 5e-05  Loss 48.4514 (40.1781)	Batch-Time 1.60 (1.23)	
2025-12-30 04:22:29,812 Epoch: [22][896/1132]	Iter 25800  lr 5e-05  Loss 39.5532 (40.0438)	Batch-Time 1.31 (1.23)	
2025-12-30 04:26:35,237 Epoch: [22][1096/1132]	Iter 26000  lr 5e-05  Loss 38.9760 (40.0180)	Batch-Time 1.24 (1.23)	
2025-12-30 04:27:24,959 Test: [0/40]		Batch-Time 3.455 (3.454)	
2025-12-30 04:27:40,875 Image to text (R@1, R@5, R@10): 82.1, 96.8, 98.2
2025-12-30 04:27:40,981 Text to image (R@1, R@5, R@10): 63.3, 86.6, 92.0
2025-12-30 04:27:40,981 Current rsum is 519.0
2025-12-30 04:27:40,983 Epoch: [22], Best rsum: 519.0
2025-12-30 04:31:09,495 Epoch: [23][164/1132]	Iter 26200  lr 5e-05  Loss 55.3528 (39.3740)	Batch-Time 1.25 (1.25)	
2025-12-30 04:35:20,636 Epoch: [23][364/1132]	Iter 26400  lr 5e-05  Loss 41.8871 (39.4979)	Batch-Time 1.98 (1.25)	
2025-12-30 04:39:28,370 Epoch: [23][564/1132]	Iter 26600  lr 5e-05  Loss 36.9741 (39.5598)	Batch-Time 1.08 (1.25)	
2025-12-30 04:43:36,173 Epoch: [23][764/1132]	Iter 26800  lr 5e-05  Loss 45.3774 (39.5960)	Batch-Time 1.02 (1.25)	
2025-12-30 04:47:43,981 Epoch: [23][964/1132]	Iter 27000  lr 5e-05  Loss 48.6441 (39.5173)	Batch-Time 1.41 (1.24)	
2025-12-30 04:51:15,556 Test: [0/40]		Batch-Time 3.409 (3.409)	
2025-12-30 04:51:31,263 Image to text (R@1, R@5, R@10): 81.4, 96.8, 98.5
2025-12-30 04:51:31,346 Text to image (R@1, R@5, R@10): 63.6, 86.4, 91.8
2025-12-30 04:51:31,346 Current rsum is 518.5
2025-12-30 04:51:31,348 Epoch: [23], Best rsum: 519.0
2025-12-30 04:52:18,399 Epoch: [24][32/1132]	Iter 27200  lr 5e-05  Loss 45.2738 (39.0357)	Batch-Time 1.18 (1.47)	
2025-12-30 04:56:30,268 Epoch: [24][232/1132]	Iter 27400  lr 5e-05  Loss 42.3626 (38.4134)	Batch-Time 1.08 (1.29)	
2025-12-30 05:00:41,075 Epoch: [24][432/1132]	Iter 27600  lr 5e-05  Loss 46.4472 (38.6851)	Batch-Time 1.26 (1.27)	
2025-12-30 05:04:44,889 Epoch: [24][632/1132]	Iter 27800  lr 5e-05  Loss 49.7478 (38.7763)	Batch-Time 1.19 (1.26)	
2025-12-30 05:08:46,041 Epoch: [24][832/1132]	Iter 28000  lr 5e-05  Loss 32.9669 (38.7753)	Batch-Time 1.32 (1.24)	
2025-12-30 05:12:52,743 Epoch: [24][1032/1132]	Iter 28200  lr 5e-05  Loss 39.4055 (38.9068)	Batch-Time 1.04 (1.24)	
2025-12-30 05:15:00,180 Test: [0/40]		Batch-Time 3.409 (3.409)	
2025-12-30 05:15:17,991 Image to text (R@1, R@5, R@10): 81.8, 96.5, 98.4
2025-12-30 05:15:18,074 Text to image (R@1, R@5, R@10): 63.1, 86.4, 91.9
2025-12-30 05:15:18,074 Current rsum is 518.1
2025-12-30 05:15:18,076 Epoch: [24], Best rsum: 519.0
2025-12-30 05:15:18,077 Current epoch num is 25, decrease all lr by 10
2025-12-30 05:15:18,077 new lr: 5e-06
2025-12-30 05:15:18,077 new lr: 5.000000000000001e-07
2025-12-30 05:15:18,077 new lr: 5e-06
2025-12-30 05:15:18,077 new lr: 5e-06
2025-12-30 05:17:26,562 Epoch: [25][100/1132]	Iter 28400  lr 5e-06  Loss 32.4076 (37.9257)	Batch-Time 1.21 (1.28)	
2025-12-30 05:21:41,008 Epoch: [25][300/1132]	Iter 28600  lr 5e-06  Loss 45.6778 (38.5104)	Batch-Time 1.18 (1.28)	
2025-12-30 05:25:45,834 Epoch: [25][500/1132]	Iter 28800  lr 5e-06  Loss 44.6096 (38.5883)	Batch-Time 1.03 (1.26)	
2025-12-30 05:29:51,604 Epoch: [25][700/1132]	Iter 29000  lr 5e-06  Loss 31.3528 (38.5946)	Batch-Time 1.05 (1.25)	
2025-12-30 05:33:57,339 Epoch: [25][900/1132]	Iter 29200  lr 5e-06  Loss 32.5917 (38.4996)	Batch-Time 1.28 (1.24)	
2025-12-30 05:38:03,403 Epoch: [25][1100/1132]	Iter 29400  lr 5e-06  Loss 45.1266 (38.4555)	Batch-Time 1.19 (1.24)	
2025-12-30 05:38:47,863 Test: [0/40]		Batch-Time 3.576 (3.575)	
2025-12-30 05:39:06,468 Image to text (R@1, R@5, R@10): 81.7, 96.2, 98.4
2025-12-30 05:39:06,552 Text to image (R@1, R@5, R@10): 63.2, 86.5, 91.9
2025-12-30 05:39:06,552 Current rsum is 517.9
2025-12-30 05:39:06,554 Epoch: [25], Best rsum: 519.0
2025-12-30 05:42:41,398 Epoch: [26][168/1132]	Iter 29600  lr 5e-06  Loss 36.3876 (38.6218)	Batch-Time 1.08 (1.28)	
2025-12-30 05:46:51,371 Epoch: [26][368/1132]	Iter 29800  lr 5e-06  Loss 40.9692 (38.4283)	Batch-Time 1.30 (1.26)	
2025-12-30 05:50:56,292 Epoch: [26][568/1132]	Iter 30000  lr 5e-06  Loss 49.2294 (38.2465)	Batch-Time 1.25 (1.25)	
2025-12-30 05:55:00,058 Epoch: [26][768/1132]	Iter 30200  lr 5e-06  Loss 37.9528 (38.0404)	Batch-Time 1.21 (1.24)	
2025-12-30 05:59:02,665 Epoch: [26][968/1132]	Iter 30400  lr 5e-06  Loss 36.8613 (38.0057)	Batch-Time 1.02 (1.24)	
2025-12-30 06:02:31,196 Test: [0/40]		Batch-Time 3.823 (3.823)	
2025-12-30 06:02:46,952 Image to text (R@1, R@5, R@10): 81.8, 96.4, 98.4
2025-12-30 06:02:47,036 Text to image (R@1, R@5, R@10): 63.1, 86.6, 91.9
2025-12-30 06:02:47,036 Current rsum is 518.3
2025-12-30 06:02:47,038 Epoch: [26], Best rsum: 519.0
2025-12-30 06:03:40,112 Epoch: [27][36/1132]	Iter 30600  lr 5e-06  Loss 32.0256 (38.9362)	Batch-Time 1.32 (1.47)	
2025-12-30 06:07:47,747 Epoch: [27][236/1132]	Iter 30800  lr 5e-06  Loss 45.0753 (38.2831)	Batch-Time 1.38 (1.27)	
2025-12-30 06:11:52,700 Epoch: [27][436/1132]	Iter 31000  lr 5e-06  Loss 38.7688 (37.7141)	Batch-Time 1.42 (1.25)	
2025-12-30 06:15:58,845 Epoch: [27][636/1132]	Iter 31200  lr 5e-06  Loss 39.9822 (37.6187)	Batch-Time 1.11 (1.24)	
2025-12-30 06:20:05,399 Epoch: [27][836/1132]	Iter 31400  lr 5e-06  Loss 27.7731 (37.6294)	Batch-Time 1.25 (1.24)	
2025-12-30 06:24:13,962 Epoch: [27][1036/1132]	Iter 31600  lr 5e-06  Loss 34.6901 (37.8207)	Batch-Time 0.99 (1.24)	
2025-12-30 06:26:20,213 Test: [0/40]		Batch-Time 3.898 (3.897)	
2025-12-30 06:26:36,057 Image to text (R@1, R@5, R@10): 81.7, 96.2, 98.6
2025-12-30 06:26:36,141 Text to image (R@1, R@5, R@10): 63.2, 86.6, 92.0
2025-12-30 06:26:36,141 Current rsum is 518.3
2025-12-30 06:26:36,142 Epoch: [27], Best rsum: 519.0
2025-12-30 06:28:52,650 Epoch: [28][104/1132]	Iter 31800  lr 5e-06  Loss 39.4806 (39.1212)	Batch-Time 1.32 (1.31)	
2025-12-30 06:33:04,147 Epoch: [28][304/1132]	Iter 32000  lr 5e-06  Loss 30.4759 (38.1846)	Batch-Time 1.22 (1.28)	
2025-12-30 06:37:08,428 Epoch: [28][504/1132]	Iter 32200  lr 5e-06  Loss 41.4239 (38.1272)	Batch-Time 1.00 (1.25)	
2025-12-30 06:41:20,781 Epoch: [28][704/1132]	Iter 32400  lr 5e-06  Loss 42.0990 (37.8479)	Batch-Time 1.22 (1.26)	
2025-12-30 06:45:27,492 Epoch: [28][904/1132]	Iter 32600  lr 5e-06  Loss 40.7376 (37.9905)	Batch-Time 1.23 (1.25)	
2025-12-30 06:49:33,505 Epoch: [28][1104/1132]	Iter 32800  lr 5e-06  Loss 37.7045 (37.9411)	Batch-Time 1.08 (1.25)	
2025-12-30 06:50:13,013 Test: [0/40]		Batch-Time 3.966 (3.965)	
2025-12-30 06:50:28,858 Image to text (R@1, R@5, R@10): 81.8, 96.4, 98.5
2025-12-30 06:50:28,943 Text to image (R@1, R@5, R@10): 63.2, 86.6, 91.9
2025-12-30 06:50:28,943 Current rsum is 518.4
2025-12-30 06:50:28,944 Epoch: [28], Best rsum: 519.0
2025-12-30 06:54:10,841 Epoch: [29][172/1132]	Iter 33000  lr 5e-06  Loss 40.3369 (38.9807)	Batch-Time 1.50 (1.29)	
2025-12-30 06:58:22,925 Epoch: [29][372/1132]	Iter 33200  lr 5e-06  Loss 34.1359 (37.9157)	Batch-Time 1.33 (1.27)	
2025-12-30 07:02:24,909 Epoch: [29][572/1132]	Iter 33400  lr 5e-06  Loss 32.9757 (37.9528)	Batch-Time 1.24 (1.25)	
2025-12-30 07:06:34,976 Epoch: [29][772/1132]	Iter 33600  lr 5e-06  Loss 34.6445 (37.8664)	Batch-Time 1.05 (1.25)	
2025-12-30 07:10:39,316 Epoch: [29][972/1132]	Iter 33800  lr 5e-06  Loss 41.6733 (37.8976)	Batch-Time 1.04 (1.25)	
2025-12-30 07:14:01,639 Test: [0/40]		Batch-Time 4.043 (4.043)	
2025-12-30 07:14:17,499 Image to text (R@1, R@5, R@10): 81.8, 96.2, 98.4
2025-12-30 07:14:17,584 Text to image (R@1, R@5, R@10): 63.2, 86.5, 91.8
2025-12-30 07:14:17,584 Current rsum is 517.9
2025-12-30 07:14:17,585 Epoch: [29], Best rsum: 519.0
2025-12-30 07:14:17,587 Train finish.
2025-12-30 07:14:17,587 Evaluate the model
